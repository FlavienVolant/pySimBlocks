name: SofaPlant
category: systems
type: sofa_plant

summary: >
  SOFA-based dynamic plant.

description: >
  Executes a SOFA simulation in a worker process.

parameters:
  scene_file:
    type: string
    required: true
    description: >
      Path to the SOFA scene file, relative to the parameters.yaml file.

  input_keys:
    type: list[string]
    required: true
    description: >
      List of input keys corresponding to SOFA input ports.

  output_keys:
    type: list[string]
    required: true
    description: >
      List of output keys corresponding to SOFA output ports.

  slider_params:
    type: dict
    required: false
    description: >
      Dictionary of slider parameters to be modified in the SOFA scene at runtime.

  sample_time:
    type: float
    required: false

ports:
  inputs:
    - name: sofa_inputs
      dynamic: true
      pattern: "{val}"
      source:
        type: parameter
        parameter: input_keys
        operation: keys
      shape: [n, 1]
      description: SOFA input ports.

  outputs:
    - name: sofa_outputs
      dynamic: true
      pattern: "{val}"
      source:
        type: parameter
        parameter: output_keys
        operation: keys
      shape: [n, 1]
      description: SOFA output ports.

execution:
  adapter: true
  direct_feedthrough: false
  has_state: true
