name: SofaExchangeIO
category: systems
type: sofa_exchange_i_o

summary: >
  Interface block for exchanging signals between pySimBlocks and SOFA.

description: >
  Provides a stateless interface block that exposes dynamic input and output
  ports to connect a pySimBlocks model with an external SOFA controller.
  This block does not execute a SOFA simulation.

parameters:
  scene_file:
    type: str
    required: false
    description: >
      Path to the SOFA scene file used for automatic generation relative to parameters.yaml file.

  input_keys:
    type: list
    required: true
    description: >
      List of input keys corresponding to SOFA input ports.

  output_keys:
    type: list
    required: true
    description: >
      List of output keys corresponding to SOFA output ports.

  slider_params:
    type: dict
    required: false
    description: >
      Dictionary of slider parameters to be modified in the SOFA scene at runtime.

  sample_time:
    type: float
    required: false

ports:
  inputs:
    - name: sofa_inputs
      dynamic: true
      pattern: "{val}"
      source:
        type: parameter
        parameter: input_keys
        operation: keys
      shape: [n, 1]
      description: Input ports provided by the external SOFA controller.

  outputs:
    - name: sofa_outputs
      dynamic: true
      pattern: "{val}"
      source:
        type: parameter
        parameter: output_keys
        operation: keys
      shape: [n, 1]
      description: Output ports consumed by the SOFA controller.

execution:
  adapter: true
  direct_feedthrough: false
  has_state: false
